!function(){"use strict";function t(t,e,r,o){var n=this;e.cartItems=[],n.cartItemsNew=[];e.cartItems.length;e.User={},e.UserShipping={},e.total=0,n.errorMessage="",n.isBusy=!0;var a="/cart/",i="/user/profile";t.get(a).then(function(t){angular.copy(t.data,e.cartItems)},function(t){n.errorMessage="Failed to load data"+t}).finally(function(){n.isBusy=!1}),n.removeItem=function(r){n.isBusy=!0,n.errorMessage="",t.post("/cart/RemoveFromCart",e.cartItems[r]).then(function(t){},function(t){n.errorMessage=t}).finally(function(){n.isBusy=!1})},e.updateQuantity=function(r){n.isBusy=!0,n.errorMessage="",t.post("/cart/UpdateQuantity",e.cartItems[r]).then(function(t){},function(t){n.errorMessage=t}).finally(function(){n.isBusy=!1})},n.sendOrder=function(){n.isBusy=!0,n.errorMessage="",t.post("/order/MakeOrder",e.cartItems).then(function(t){},function(t){n.errorMessage=t}).finally(function(){n.isBusy=!1})},e.addition=function(t){e.cartItems[t].quantity=e.cartItems[t].quantity+1,e.total+=e.cartItems[t].product.price,e.updateQuantity(t)},e.substract=function(t){e.cartItems[t].quantity>1&&(e.cartItems[t].quantity=e.cartItems[t].quantity-1,e.total-=e.cartItems[t].product.price,e.updateQuantity(t))},e.calculateTotal=function(t){e.total+=e.cartItems[t].quantity*e.cartItems[t].product.price},e.calculateTotalAfterRemove=function(t){e.total-=e.cartItems[t].product.price*e.cartItems[t].quantity,n.removeItem(t),e.cartItems.splice(t,1),$(".shop-badge .badge").text(e.cartItems.length)},t.get(i).then(function(t){angular.copy(t.data,e.User)},function(t){n.errorMessage="Failed to load user"}).finally(function(){n.isBusy=!1}),n.updateUser=function(){n.isBusy=!0,n.errorMessage="",t.post(i,e.User).then(function(t){},function(t){n.errorMessage="Failed to update the user"+t}).finally(function(){n.isBusy=!1})},e.copyUserInformations=function(){e.UserShipping=angular.copy(e.User)},e.firstHeaderColor="#313788",e.firstTabActive=!0,e.secondTabActive=!1,e.thirdTabActive=!1,e.showFirstTab=function(){e.firstHeaderColor="#313788",e.secondHeaderColor="#4765A0",e.thirdHeaderColor="#4765A0",e.thirdTabActive=!1,e.secondTabActive=!1,e.firstTabActive=!0},e.showSecondTab=function(){e.firstHeaderColor="#4765A0",e.secondHeaderColor="#313788",e.thirdHeaderColor="#4765A0",e.firstTabActive=!1,e.secondTabActive=!0,e.thirdTabActive=!1},e.showThirdTab=function(){e.firstHeaderColor="#4765A0",e.secondHeaderColor="#4765A0",e.thirdHeaderColor="#313788",n.updateUser(),e.firstTabActive=!1,e.secondTabActive=!1,e.thirdTabActive=!0},e.open=function(){r.open({templateUrl:"myModalContent.html",backdrop:!0,keyboard:!0,windowClass:"center-modal",size:"sm",animation:"true",appendTo:"middle",controller:["$scope","$modalInstance","$log","user",function(t,e,r,o){t.user=o,t.submit=function(){r.log("Submiting user info."),r.log(o),e.dismiss("cancel")},t.cancel=function(){document.location.href="/",e.dismiss("cancel")}}],resolve:{user:function(){return e.user}}})}}t.$inject=["$http","$scope","$uibModal","$location"],angular.module("app-shoppingCart").controller("shoppingCartController",t)}();